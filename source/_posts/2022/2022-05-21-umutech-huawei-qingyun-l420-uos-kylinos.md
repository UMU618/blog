---
layout: post
title: 用华为擎云 L420 体验国产操作系统（UOS 和银河麒麟）
date: 2022-05-21 12:45:55
categories: UMUTech
tags:
- debian
- debug
- linux
- ops
---
## 用户故事

稣很爱国！从 2019 年起，就不时想用国产操作系统，但基本停留在虚拟机体验的层次，今年终于在物理机长期实践了。

## 建议

最好别买工程机。如果非要买的话，要同时看准 BIOS 和 EC 的版本。

## 硬件环境

华为擎云 L420 工程机，型号是 KLVV W5821。

- BIOS Revision: 0.9
- Firmware Revision: 0.8
- hisi Version: 1.0.0.3

某鱼上捡的，外观惨不忍睹，而且就一个主机，配件全无。

到手时，是残缺状态的 UOS 20 1022，基本不能用，只能开机看个寂寞。也是，要不然也不可能 2000 块以内买到……

## 体验 UOS 20 1041

加了统信两个企业微信群，好不容易要到了一个 iso，然而根本不能启动。稣激动地插入 U 盘，结果它直接黑屏死掉！

机智如稣，立刻想到原来的系统可以启动，把旧系统的内核拿来用不就行了？em，这么干确实成功启动。

之前的系统缺失应用商店等系统组件，装完系统后，总算是一个完整的 UOS 了。然而内核还是旧的，所以……八哥如下：

1. 内建显示器无法调节亮度，只有关闭和中等亮度两个状态。【稣含着泪，倔强地说道：稣就当服务器用，要什么内建显示器？】

2. 外接显示器没反应。【稣含着泪，倔强地说道：稣就当服务器用，要什么外接显示器？】

3. 偶尔开机后没声音。不过注销一下，再登录就能恢复。【稣含着泪，倔强地说道：稣就当服务器用，要什么扬声器？】

4. 从待机状态恢复后，有小概率内建键盘失灵或内建触摸板控制不了光标。但外接键鼠没问题。【稣含着泪，倔强地说道：稣就当服务器用，要什么键鼠？】

5. 拔下充电器后，任务栏的电池图标依然一直显示正在充电。

6. 最可怕的是：开机久了，比如两三周，就有可能无法关机。前兆是同时键盘失灵，这时候关机，并不会真的断电，卡死在一个硬件奇异点，长按开关机键也无用，只能拆后盖断电池排线才能解决。据机友反馈，BIOS 0.11 也有这个问题。

好吧，以上问题都是因为固件的版本太低，只能用充满八哥的低版本内核。只要升级固件，再升级相应的内核就可以解决。但是升级固件这个事太难了……这可是一个奇怪的工程机啊！正规手段都是各种失败，即使是解开固件 deb 包，手动运行 BIOSEC，让它分离出 Firmware.bin 和 Update.txt，也失败！把 Firmware.bin 拿去 BIOS 界面升级固件，依然失败！

BIOS 是百敖 0.09，果然难搞！好吧，没刷成砖头就好。咱们来日方长……【稣含着泪，倔强地说道：学习是终生的，而问题都是一时的！】

接下来说说系统本身的问题：其实 UOS 本身没问题，稣很满意，还是个适配的问题。

L420 的显示服务器是 xwayland，因为其使用的 mali GPU 的用户态驱动是闭源的，只支持 wayland，不支持 x11。这导致部分稣常用的软件无法正常工作，比如远程桌面客户端，em……目前还没发现能用的。【稣含着泪，倔强地说道：稣就当服务器用，要什么客户端？】

## 体验银河麒麟桌面操作系统 V10

听说银河麒麟更爱国，稣从它的壁纸就可以看出来，这绝对是真的！

![银河麒麟桌面](/images/2022/20220521-desktop.jpg)

还是熟悉的味道，原版 iso 无法启动，换内核，启动正常，安装也正常。

银河麒麟不愧是上个世纪就诞生的国产操作系统，十分满意，默认设置，只有一个地方稣无法忍受——居然不是默认开启「自然滚动」！而且，图形界面下居然没地方设置？不知道和没激活有没有关系？

![银河麒麟-设置-设备-触摸板](/images/2022/20220521-touchpad.png)

但是这对使用 Debian 4 年以上经验的稣来说，简直易如反掌，命令行搞定，注销重新登录生效：

```sh
gsettings set org.ukui.peripherals-touchpad natural-scroll true
```

在另一台机器（非 L420）安装银河麒麟后，又发现一个问题比较难以接受：外接显示器的放大比例无法独立设置！

![银河麒麟-设置-系统-显示器](/images/2022/20220521-display.png)

任务栏这个风格也不太方便，还是合并到一起好。

![银河麒麟-任务栏](/images/2022/20220521-taskbar.png)

另外有一个惊喜，文件管理器借鉴了 macOS 的做法，有个颜色分类功能，很不错！（访达少数满意的地方）

![银河麒麟-文件管理器](/images/2022/20220521-finder.png)

## 其他机友关于 BIOS 版本的经验

以下非本人经验，仅供参考，不保证正确性，也不提供相关资助：

- BIOS 0.11：目前也是升级无望，有机友已经找过华为工程师，结果都搞不定。

- BIOS 0.18：根据不止一人反馈，是可以升级到 1.x 的。

- 某鱼兼某论坛上的大佬说任何 BIOS 都是能升级的，但 EC 无法升级。

- 推测，有些八哥可能来自 EC，所以如果 EC 无法升级，那么即使 BIOS 升级好也无法解决这些八哥，那就只能拆换配件了。
